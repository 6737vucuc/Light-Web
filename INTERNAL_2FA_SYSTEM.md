# ูุธุงู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ ุงููุฏูุฌ (Internal 2FA & Trusted Devices)

## ๐ก๏ธ ูุธุฑุฉ ุนุงูุฉ
ุชู ุงุณุชุจุฏุงู ูุธุงู Google Authenticator ุงูุฎุงุฑุฌู ุจูุธุงู ุฃูุงู ูุฏูุฌ ุฃูุซุฑ ุงุญุชุฑุงููุฉ ูุงุณุชููุงููุฉ. ูุนุชูุฏ ุงููุธุงู ุงูุฌุฏูุฏ ุนูู ุงูุชุญูู ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุชูุซูู ุงูุฃุฌูุฒุฉ ุงูููุซููุฉ (Trusted Devices).

---

## ๐ ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. ุงููุตุงุฏูุฉ ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (Email-Based 2FA)
- ุจุฏูุงู ูู ุงูุงุนุชูุงุฏ ุนูู ุชุทุจููุงุช ุฎุงุฑุฌูุฉุ ูุชู ุฅุฑุณุงู ุฑูุฒ ุชุญูู ูุฑูุฏ (6 ุฃุฑูุงู) ูุจุงุดุฑุฉ ุฅูู ุจุฑูุฏ ุงููุณุชุฎุฏู.
- ุงูุฑููุฒ ุตุงูุญุฉ ููุฏุฉ 10 ุฏูุงุฆู ููุท ูุชูุณุชุฎุฏู ููุฑุฉ ูุงุญุฏุฉ.
- ุชุตููู ุงุญุชุฑุงูู ูุฑุณุงุฆู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุชุถูู ุชูุงุตูู ูุญุงููุฉ ุงูุฏุฎูู (ุงููุชุตูุญุ ุงููููุนุ ุงูููุช).

### 2. ูุธุงู ุงูุฃุฌูุฒุฉ ุงูููุซููุฉ (Trusted Devices)
- ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู ูู ุฌูุงุฒ ุฌุฏูุฏุ ููุทูุจ ุฑูุฒ ุงูุชุญูู ุชููุงุฆูุงู.
- ูููู ูููุณุชุฎุฏู ุงุฎุชูุงุฑ "ุงููุซูู ุจูุฐุง ุงูุฌูุงุฒ" (Trust this device) ูุชุฎุทู ุงูุชุญูู ูู ุงููุฑุงุช ุงููุงุฏูุฉ ูู ููุณ ุงูุฌูุงุฒ.
- ูุชู ุฅูุดุงุก ุจุตูุฉ ูุฑูุฏุฉ (Fingerprint) ููู ุฌูุงุฒ ุจูุงุกู ุนูู ุงููุชุตูุญ ูุนููุงู IP.

### 3. ุชูุจููุงุช ุงูุฃูุงู ุงูููุฑูุฉ
- ูุชู ุฅุฑุณุงู ุชูุจูู ููุฑู ููุจุฑูุฏ ุงูุฅููุชุฑููู ุนูุฏ ุฅุถุงูุฉ ุฌูุงุฒ ููุซูู ุฌุฏูุฏ.
- ูุชู ุฅุฑุณุงู ุชูุจูู ุนูุฏ ูุญุงููุฉ ุงูุฏุฎูู ูู ูููุน ุฌุบุฑุงูู ุบุฑูุจ ุฃู ูุชุตูุญ ูุฎุชูู.

---

## ๐๏ธ ุงูุชุบููุฑุงุช ุงูุชูููุฉ

### ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ:
1. **`trusted_devices`**: ูุชุฎุฒูู ุจุตูุงุช ุงูุฃุฌูุฒุฉ ุงูููุซููุฉ ููู ูุณุชุฎุฏู.
2. **`internal_2fa_codes`**: ูุชุฎุฒูู ูุฅุฏุงุฑุฉ ุฑููุฒ ุงูุชุญูู ุงููุฑุณูุฉ ุนุจุฑ ุงูุจุฑูุฏ.

### ุงููููุงุช ุงูุจุฑูุฌูุฉ ุงูุฑุฆูุณูุฉ:
- `lib/auth/internal-2fa.ts`: ุงูููุชุจุฉ ุงููุฑูุฒูุฉ ูุฅุฏุงุฑุฉ ุงููุธุงู ุงูุฌุฏูุฏ.
- `app/api/auth/login/route.ts`: ุชุญุฏูุซ ููุทู ุชุณุฌูู ุงูุฏุฎูู ููุฏูุฌ ุงูุชุญูู ูู ุงูุฃุฌูุฒุฉ.
- `lib/security-email.ts`: ุฅุถุงูุฉ ููุงูุจ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงูุงุญุชุฑุงููุฉ ููุชุญูู ูุงูุชูุจููุงุช.
- `app/[locale]/auth/login/page.tsx`: ูุงุฌูุฉ ูุณุชุฎุฏู ุฌุฏูุฏุฉ ูููุงู ุชุฏุนู ุงููุธุงู ุงููุฏูุฌ.

---

## ๐งช ููู ุชุฎุชุจุฑ ุงููุธุงูุ

1. **ุชุณุฌูู ุงูุฏุฎูู ุงูุฃูู:**
   - ุฃุฏุฎู ุจุฑูุฏู ููููุฉ ุงููุฑูุฑ.
   - ุณูุธูุฑ ูู ูุธุงู ุงูุชุญูู ุงููุฏูุฌ ููุฎุจุฑู ุจุฅุฑุณุงู ุฑูุฒ ูุจุฑูุฏู.
   - ุชุญูู ูู ุจุฑูุฏู (ุฃู logs ุงูุฎุงุฏู) ููุญุตูู ุนูู ุงูุฑูุฒ.
   
2. **ุงููุซูู ุจุงูุฌูุงุฒ:**
   - ุฃุฏุฎู ุงูุฑูุฒ ูุชุฃูุฏ ูู ุชูุนูู ุฎูุงุฑ "Trust this device".
   - ุจุนุฏ ุงูุฏุฎููุ ุณุฌู ุฎุฑูุฌ ูุญุงูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู.
   - ุณุชูุงุญุธ ุฃู ุงููุธุงู ูู ูุทูุจ ุงูุฑูุฒ ูุฐู ุงููุฑุฉ ูุฃู ุงูุฌูุงุฒ ุฃุตุจุญ ููุซููุงู.

3. **ุชุบููุฑ ุงูุฌูุงุฒ/ุงููุชุตูุญ:**
   - ุญุงูู ุงูุฏุฎูู ูู ูุชุตูุญ ุขุฎุฑ (Incognito mode ูุซูุงู).
   - ุณูุทูุจ ููู ุงููุธุงู ุฑูุฒ ุงูุชุญูู ูุฑุฉ ุฃุฎุฑู ูุฃู ุงูุจุตูุฉ ุชุบูุฑุช.

---

## ๐ ุงูุฃูุงู ุงููุชุทูุฑ
- โ **ุญูุงูุฉ ุถุฏ ุงููุฌูุงุช:** ุงููุธุงู ูููู ูู ุฎุทุฑ ุณุฑูุฉ ูููุงุช ุงููุฑูุฑ ูุฃู ุงููุตูู ูุชุทูุจ ุงููุตูู ููุจุฑูุฏ ุงูุฅููุชุฑููู ุฃูุถุงู.
- โ **ุงุณุชููุงููุฉ ูุงููุฉ:** ูุง ูุนุชูุฏ ุนูู ุฎุฏูุงุช ุฎุงุฑุฌูุฉ (ุฌูุฌู ุฃู ุบูุฑูุง)ุ ููุง ูุนุทู ุฎุตูุตูุฉ ุฃูุจุฑ ูููุณุชุฎุฏู.
- โ **ุชุชุจุน ุดุงูู:** ูู ูุญุงููุฉ ุฏุฎูู ููุซูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน ุชูุงุตูู ุงูุฌูุงุฒ ูIP.

---

**โจ ุชู ุชุญุฏูุซ ุงููุธุงู ุจูุฌุงุญ ููููู ุฃูุซุฑ ุฃูุงูุงู ูุงุญุชุฑุงููุฉ!**
