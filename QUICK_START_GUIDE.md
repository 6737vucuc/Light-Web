# دليل البدء السريع - تحديثات Instagram

## نظرة عامة

تم تحديث قسم Public في مشروع Light-Web بنجاح ليصبح مشابهاً لنظام Instagram مع الحفاظ على الدردشة الجماعية الموجودة.

## التحديثات الرئيسية

### 1. نظام اليوزرنيم (@username)
- كل مستخدم لديه الآن يوزرنيم فريد
- يمكن البحث عن المستخدمين باليوزرنيم
- **قيد مهم**: لا يمكن تغيير اليوزرنيم إلا مرة واحدة كل 30 يوم

### 2. صفحة الملف الشخصي للمجتمع
**المسار**: `/user-profile/[userId]`

**المميزات**:
- تصميم شبكي للمنشورات (Grid Layout)
- عرض الإحصائيات: عدد المنشورات، المتابعين، المتابَعين
- زر Follow/Unfollow
- دعم الحسابات الخاصة (Private Accounts)
- ثلاث تبويبات:
  - **Posts**: جميع منشورات المستخدم
  - **Saved**: المنشورات المحفوظة (للملف الشخصي فقط)
  - **Tagged**: المنشورات التي تم وسم المستخدم فيها

**إعدادات الخصوصية**:
- حساب خاص/عام
- إخفاء قائمة المتابعين
- إخفاء قائمة المتابَعين
- التحكم في من يمكنه التعليق
- التحكم في من يمكنه إرسال رسائل

### 3. نظام المراسلة الخاصة (Instagram DM)
**المسار**: `/messages`

**المميزات**:
- تصميم نظيف بعمودين (قائمة المحادثات + نافذة الدردشة)
- البحث في المحادثات بالاسم أو اليوزرنيم
- إرسال نصوص وصور
- Reactions (تفاعلات emoji) على الرسائل
- مؤشر الكتابة (Typing Indicator)
- حالة القراءة (✓ و ✓✓)
- حذف الرسائل
- مؤشر الحالة (Online/Offline)

### 4. الفصل بين الملفات الشخصية

#### الملف الشخصي الرئيسي (`/profile`)
- إعدادات الحساب الشخصية
- تتبع الدروس والتقدم
- تغيير كلمة المرور والبريد الإلكتروني
- المصادقة الثنائية

#### ملف المجتمع (`/user-profile/[userId]`)
- الملف الشخصي العام بتصميم Instagram
- التفاعلات الاجتماعية (متابعة، رسائل)
- المنشورات والقصص
- إعدادات خصوصية المجتمع

## خطوات التشغيل

### 1. تشغيل Migration لقاعدة البيانات

```bash
# تشغيل migration لإضافة حقل username
psql -d your_database_name -f drizzle/0004_add_username.sql
```

أو باستخدام Drizzle:

```bash
npm run db:push
# أو
pnpm db:push
```

### 2. تحديث المتغيرات البيئية

تأكد من وجود هذه المتغيرات في ملف `.env`:

```env
DATABASE_URL="your_database_url"
NEXT_PUBLIC_PUSHER_APP_KEY="your_pusher_key"
NEXT_PUBLIC_PUSHER_CLUSTER="your_pusher_cluster"
```

### 3. تثبيت التبعيات (إن لزم الأمر)

```bash
pnpm install
```

### 4. تشغيل المشروع

```bash
pnpm dev
```

## ملاحظات مهمة

### اليوزرنيم الافتراضي
- جميع المستخدمين الحاليين سيحصلون على يوزرنيم افتراضي بصيغة: `user_[id]`
- يجب على المستخدمين تغيير اليوزرنيم الافتراضي إلى يوزرنيم مخصص
- بعد التغيير الأول، لا يمكن تغييره إلا بعد 30 يوم

### الدردشة الجماعية
- **تم الحفاظ عليها بالكامل** ولم يتم المساس بها
- لا تزال موجودة في صفحة `/community` تحت تبويب "Group Chat"
- جميع الوظائف القديمة تعمل بشكل طبيعي

### الملفات الاحتياطية
تم إنشاء نسخ احتياطية من الملفات القديمة:
- `app/user-profile/[userId]/page-old.tsx`
- `app/messages/page-old.tsx`
- `lib/db/schema-backup.ts`

## الاختبار

### قائمة الاختبار
- [ ] إنشاء يوزرنيم جديد
- [ ] محاولة تغيير اليوزرنيم قبل 30 يوم (يجب أن يفشل)
- [ ] متابعة مستخدم آخر
- [ ] إلغاء المتابعة
- [ ] تحويل الحساب إلى خاص
- [ ] إرسال طلب متابعة لحساب خاص
- [ ] إرسال رسالة مباشرة
- [ ] إضافة reaction على رسالة
- [ ] حفظ منشور
- [ ] عرض المنشورات المحفوظة
- [ ] التحقق من أن الدردشة الجماعية تعمل

## استكشاف الأخطاء

### مشكلة: اليوزرنيم لا يظهر
**الحل**: تأكد من تشغيل migration قاعدة البيانات

### مشكلة: الرسائل لا تصل فوراً
**الحل**: تحقق من إعدادات Pusher والمتغيرات البيئية

### مشكلة: لا يمكن رؤية المنشورات في الملف الشخصي
**الحل**: تحقق من إعدادات الخصوصية للحساب

## الدعم الفني

للمزيد من المعلومات، راجع:
- `INSTAGRAM_UPDATES.md` - توثيق تفصيلي للتحديثات
- `ANALYSIS_NOTES.md` - ملاحظات التحليل الأولي

## التحديثات المستقبلية المقترحة

- Story Highlights (أبرز القصص)
- منشورات الفيديو
- الرسائل الصوتية في DM
- مكالمات الفيديو
- المجموعات في DM
- إحصائيات المنشورات
- شارات التوثيق

---

**تاريخ التحديث**: نوفمبر 2025
**الإصدار**: 2.0.0 - Instagram Style Update
