# ุฏููู ุงุฎุชุจุงุฑ ุงูููุงููุงุช ุงูุตูุชูุฉ

## ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

ุชู ุฅุตูุงุญ ูุดููุฉ ุฒุฑ ุงูุงุณุชุฌุงุจุฉ ูุจุซ ุงูุตูุช ุงูุญูููู ูู ุงูููุงููุงุช. ุงูุขู ุงูููุงููุงุช ุชุนูู ุจุดูู ูุงูู ูุน ุจุซ ุตูุช ุญูููู ูู ุงูุงุชุฌุงููู.

## ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### 1. ุงูุชุญุถูุฑ

ูุจู ุงูุจุฏุกุ ุชุฃูุฏ ูู:
- โ ุฑูุน ุงูุชุบููุฑุงุช ุฅูู ุงูุฅูุชุงุฌ (Vercel/Netlify)
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุญุชูู ุนูู ุนููุฏ `current_peer_id` ูู ุฌุฏูู `users` (ููุฌูุฏ ุจุงููุนู)
- โ ูุฏูู ุญุณุงุจูู ูุฎุชูููู ููุงุฎุชุจุงุฑ

### 2. ูุชุญ ุงููุชุตูุญุงุช

1. ุงูุชุญ ูุชุตูุญูู ูุฎุชูููู (ุฃู ูุงูุฐุชูู incognito)
2. ูู ุงููุชุตูุญ ุงูุฃูู: ุณุฌู ุฏุฎูู ุจุงูุญุณุงุจ ุงูุฃูู
3. ูู ุงููุชุตูุญ ุงูุซุงูู: ุณุฌู ุฏุฎูู ุจุงูุญุณุงุจ ุงูุซุงูู

### 3. ุจุฏุก ูุญุงุฏุซุฉ

1. ูู ุฃู ูุชุตูุญ: ุงุฐูุจ ุฅูู ุตูุญุฉ ุงููุฌุชูุน
2. ุงุจุญุซ ุนู ุงููุณุชุฎุฏู ุงูุขุฎุฑ ูุงูุถู ุฅูู ูุฌููุนุฉ ูุดุชุฑูุฉ
3. ุงุถุบุท ุนูู ุฃููููุฉ ุงูุฑุณุงุฆู ูุจุฏุก ูุญุงุฏุซุฉ ุฎุงุตุฉ
4. ุฃุฑุณู ุฑุณุงูุฉ ููุชุฃูุฏ ูู ุฃู ุงููุญุงุฏุซุฉ ุชุนูู

### 4. ุงุฎุชุจุงุฑ ุงูููุงููุฉ

#### ูู ุงููุชุตูุญ ุงูุฃูู (ุงููุชุตู):
1. ุงุถุบุท ุนูู ุฃููููุฉ ุงููุงุชู ๐
2. ูุฌุจ ุฃู ูุทูุจ ุงููุชุตูุญ ุฅุฐู ุงููููุฑูููู - **ุงูุจู ุงูุฅุฐู**
3. ูุฌุจ ุฃู ุชุธูุฑ ูุงุฌูุฉ ุงูููุงููุฉ ุจุญุงูุฉ "Calling..."

#### ูู ุงููุชุตูุญ ุงูุซุงูู (ุงููุณุชูุจู):
1. ูุฌุจ ุฃู ุชุธูุฑ ูุงุฌูุฉ ุงูููุงููุฉ ุงููุงุฑุฏุฉ ุชููุงุฆูุงู
2. ูุฌุจ ุฃู ุชุฑู ุงุณู ุงููุชุตู ูุตูุฑุชู
3. ุงุถุบุท ุนูู ุฒุฑ **Accept** (ุงููุจูู) โ
4. ูุฌุจ ุฃู ูุทูุจ ุงููุชุตูุญ ุฅุฐู ุงููููุฑูููู - **ุงูุจู ุงูุฅุฐู**
5. ูุฌุจ ุฃู ุชุชุบูุฑ ุงูุญุงูุฉ ุฅูู "Connected"

### 5. ุงุฎุชุจุงุฑ ุจุซ ุงูุตูุช

1. **ูู ุงููุชุตูุญ ุงูุฃูู**: ุชุญุฏุซ ูู ุงููููุฑูููู
2. **ูู ุงููุชุตูุญ ุงูุซุงูู**: ูุฌุจ ุฃู ุชุณูุน ุงูุตูุช ุจูุถูุญ
3. **ูู ุงููุชุตูุญ ุงูุซุงูู**: ุชุญุฏุซ ูู ุงููููุฑูููู
4. **ูู ุงููุชุตูุญ ุงูุฃูู**: ูุฌุจ ุฃู ุชุณูุน ุงูุตูุช ุจูุถูุญ

### 6. ุฅููุงุก ุงูููุงููุฉ

1. ูู ุฃู ูุชุตูุญ: ุงุถุบุท ุนูู ุฒุฑ **End Call** (ุฅููุงุก ุงูููุงููุฉ)
2. ูุฌุจ ุฃู ุชูุชูู ุงูููุงููุฉ ูู ููุง ุงููุชุตูุญูู
3. ูุฌุจ ุฃู ุชุนูุฏ ุฅูู ูุงุฌูุฉ ุงููุญุงุฏุซุฉ ุงูุนุงุฏูุฉ

## ุงูุชุญูู ูู Console Logs

ุงูุชุญ Developer Tools (F12) ูู ููุง ุงููุชุตูุญูู ูุชุญูู ูู Console:

### ูู ูุชุตูุญ ุงููุชุตู ูุฌุจ ุฃู ุชุฑู:
```
PeerJS connected with ID: light-user-XXX
PeerID stored in database: light-user-XXX
[Call] Microphone access granted
[Call] Receiver PeerID: light-user-YYY
[Call] Supabase notification sent
[Call] PeerJS call initiated to: light-user-YYY
[Call] Setting up call event handlers
[Call] Received remote stream: MediaStream {...}
[Call] Remote stream tracks: [MediaStreamTrack]
[Call] Remote audio playing successfully
[Call] Audio element volume: 1
```

### ูู ูุชุตูุญ ุงููุณุชูุจู ูุฌุจ ุฃู ุชุฑู:
```
PeerJS connected with ID: light-user-YYY
PeerID stored in database: light-user-YYY
Incoming call received: {...}
[Call] Receiving WebRTC call from: light-user-XXX
[Call] No stream yet, call object saved for later answer
[Call] Accepting call from: XXX with PeerID: light-user-XXX
[Call] Microphone access granted for receiver
[Call] Answering existing PeerJS call
[Call] Setting up call event handlers
[Call] Acceptance notification sent
[Call] Received remote stream: MediaStream {...}
[Call] Remote stream tracks: [MediaStreamTrack]
[Call] Remote audio playing successfully
[Call] Audio element volume: 1
```

## ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุงููุดููุฉ: "Connection not ready"
**ุงูุญู**: 
- ุงูุชุธุฑ ุจุถุน ุซูุงู ุญุชู ูุชู ุฅูุดุงุก PeerJS connection
- ุชุญูู ูู Console ุฃู ุฑุณุงูุฉ "PeerJS connected with ID" ุธูุฑุช
- ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ ุฅุฐุง ูุฒู ุงูุฃูุฑ

### ุงููุดููุฉ: "Receiver is not online or not available for calls"
**ุงูุญู**:
- ุชุฃูุฏ ุฃู ุงููุณุชุฎุฏู ุงูุขุฎุฑ ูุณุฌู ุฏุฎูู ูููุฌูุฏ ูู ุตูุญุฉ ุงููุญุงุฏุซุงุช
- ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู `current_peer_id` ููุณ NULL ูููุณุชุฎุฏู ุงูุขุฎุฑ
- ุฃุนุฏ ุชุญููู ุตูุญุฉ ุงููุณุชุฎุฏู ุงูุขุฎุฑ

### ุงููุดููุฉ: ูุง ูุธูุฑ ุฅุดุนุงุฑ ุงูููุงููุฉ ุงููุงุฑุฏุฉ
**ุงูุญู**:
- ุชุญูู ุฃู Supabase Realtime ูุนูู ุจุดูู ุตุญูุญ
- ุชุญูู ูู Console ุฃู ุฑุณุงูุฉ "Supabase Realtime Subscribed!" ุธูุฑุช
- ุชุฃูุฏ ุฃู ููุง ุงููุณุชุฎุฏููู ูู ููุณ channel

### ุงููุดููุฉ: ูุง ููุฌุฏ ุตูุช
**ุงูุญู**:
- ุชุญูู ุฃู ุฅุฐู ุงููููุฑูููู ููููุญ ูู ููุง ุงููุชุตูุญูู
- ุชุญูู ูู Console ุฃู ุฑุณุงูุฉ "Remote audio playing successfully" ุธูุฑุช
- ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุตูุช ูู ูุธุงู ุงูุชุดุบูู
- ุฌุฑุจ ุฑูุน ูุณุชูู ุงูุตูุช ูู ุงููุชุตูุญ
- ุฅุฐุง ุธูุฑุช ุฑุณุงูุฉ "Please click anywhere to enable audio"ุ ุงุถุบุท ูู ุฃู ููุงู ูู ุงูุตูุญุฉ

### ุงููุดููุฉ: "Audio play error"
**ุงูุญู**:
- ุจุนุถ ุงููุชุตูุญุงุช ุชููุน ุชุดุบูู ุงูุตูุช ุชููุงุฆูุงู
- ุงุถุบุท ูู ุฃู ููุงู ูู ุงูุตูุญุฉ ูุชูุนูู ุงูุตูุช
- ุชุฃูุฏ ุฃู autoplay ูุณููุญ ูู ุฅุนุฏุงุฏุงุช ุงููุชุตูุญ

## ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

ููููู ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุชุฃูุฏ ูู ุชุฎุฒูู PeerID:

```sql
SELECT id, name, current_peer_id, is_online 
FROM users 
WHERE current_peer_id IS NOT NULL;
```

ูุฌุจ ุฃู ุชุฑู ุงููุณุชุฎุฏููู ุงููุชุตููู ูุน `current_peer_id` ุงูุฎุงุต ุจูู.

## ููุงุญุธุงุช ูููุฉ

1. **ูุฌุจ ุฃู ูููู ููุง ุงููุณุชุฎุฏููู ูุชุตููู (online)** ูู ููุณ ุงูููุช
2. **ูุฌุจ ููุญ ุฅุฐู ุงููููุฑูููู** ูู ููุง ุงููุชุตูุญูู
3. ุงูููุงููุงุช ุชุณุชุฎุฏู **WebRTC** ููุงุชุตุงู ุงููุจุงุดุฑ ุจูู ุงููุชุตูุญูู
4. **Supabase Realtime** ูุณุชุฎุฏู ููุท ููุฅุดุนุงุฑุงุช ูุฅุฏุงุฑุฉ ุญุงูุฉ ุงูููุงููุฉ
5. ุจุซ ุงูุตูุช ูุชู **ูุจุงุดุฑุฉ ุจูู ุงููุชุตูุญูู** ุนุจุฑ PeerJS
6. ุฅุฐุง ูุงู ุฃุญุฏ ุงููุณุชุฎุฏููู ุฎูู firewall ูููุ ูุฏ ุชุญุชุงุฌ ุฅูู TURN server ุฅุถุงูู

## ุงูุฏุนู ุงูููู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู ุจุนุฏ ุงุชุจุงุน ูุฐู ุงูุฎุทูุงุช:

1. ุงูุชุญ Developer Tools (F12)
2. ุงุฐูุจ ุฅูู Console tab
3. ุงูุณุฎ ุฌููุน ุงูุฑุณุงุฆู ุงูุชู ุชุจุฏุฃ ุจู `[Call]` ุฃู `PeerJS`
4. ุฃุฑุณููุง ูููุทูุฑ ูููุณุงุนุฏุฉ ูู ุชุดุฎูุต ุงููุดููุฉ

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ**: 8 ูุจุฑุงูุฑ 2026  
**ุงูุญุงูุฉ**: โ ุชู ุงูุฅุตูุงุญ ูุงูุงุฎุชุจุงุฑ
